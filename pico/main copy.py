from machine import Pin, SPI
import utime
import time
import framebuf
from fb_numbers import NUMBERS
from fb_top_icons import TOP_ICONS
from fb_bottom_icons import BOTTOM_ICONS
from fb_vane import VANE
from fb_fan import FAN

from screen_driver import EPD

"""
from screen_controller import ScreenController

sc = ScreenController()


while True:
    sc.display()
    sc.top_auto.toggle()
    print('hello')
    time.sleep(1)
"""

spi = SPI(0, bits=8, baudrate=20000000, polarity=0, phase=0, sck=Pin(18), mosi=Pin(19), miso=Pin(16))
cs = Pin(20, Pin.OUT)
dc = Pin(21, Pin.OUT)
rst = Pin(15, Pin.OUT)
busy = Pin(14, Pin.IN)


epd = EPD(spi, cs, dc, rst, busy)
epd.init(epd.FULL_UPDATE)
time.sleep(1)

buf = bytearray(epd.width * epd.height // 8)
fb = framebuf.FrameBuffer(buf, epd.height, epd.width, framebuf.MONO_VLSB)


# --------------------

top_offset = 6
left_offset = 0

fb.fill(0)
# fb.text('MicroPython!', 2, 40, 0xffff)

fb.hline(0 + left_offset, 32 + top_offset, epd.height - 1, 0xffff)
fb.hline(0 + left_offset, 33 + top_offset, epd.height - 1, 0xffff)

fb.vline(150 + left_offset, 32 + top_offset, epd.width - 1, 0xffff)
fb.vline(151 + left_offset, 32 + top_offset, epd.width - 1, 0xffff)

# Top Icons
separation = 28 + 3
fb.blit(TOP_ICONS['auto'], 4 + left_offset, 1 + top_offset)
fb.blit(TOP_ICONS['cool'], 4 + left_offset + separation * 1, 1 + top_offset)
fb.blit(TOP_ICONS['dry'], 4 + left_offset + separation * 2, 1 + top_offset)
fb.blit(TOP_ICONS['heat'], 4 + left_offset + separation * 3, 1 + top_offset)
fb.blit(TOP_ICONS['fan'], 4 + left_offset + separation * 4, 1 + top_offset)
fb.blit(TOP_ICONS['econo_cool'], 4 + left_offset + separation * 5, 1 + top_offset)
fb.blit(TOP_ICONS['wifi'], epd.height - 4 + left_offset - 28, 1 + top_offset)

# Degrees
fb.blit(BOTTOM_ICONS['thermometer'], 4 + left_offset, 35 + top_offset)
fb.blit(NUMBERS['1'], 15 + left_offset, 42 + top_offset)
fb.blit(NUMBERS['3'], 15 + 51 + left_offset, 42 + top_offset)
fb.blit(BOTTOM_ICONS['celcius'], 114 + left_offset, 94 + top_offset)

# bottom right icons
fb.blit(BOTTOM_ICONS['fan'], 157 + left_offset, 37 + top_offset)
fb.blit(BOTTOM_ICONS['auto'], 182 + left_offset, 37 + top_offset)
fb.blit(BOTTOM_ICONS['low_battery'], 215 + left_offset, 38 + top_offset)
fb.blit(BOTTOM_ICONS['quiet'], 157 + left_offset, 61 + top_offset)
fb.blit(BOTTOM_ICONS['auto'], 157 + left_offset, 84 + top_offset)

fb.blit(FAN['4'], 183 + left_offset, 59 + top_offset)

fb.blit(VANE['swing'], 179 + left_offset, 80 + top_offset)

epd.set_frame_memory(buf, 0, 0, epd.width, epd.height)
epd.display_frame()
epd.sleep()

while True:
    time.sleep(1)

# fb.rect(20, 20, 100, 50, 0xffff)
# fb.line(20, 20, 119, 69, 0xffff)

#fb.rect(0, y_start, 250, 122, 0xffff)

up = bytearray(b'\x01\x80\x03\xc0\x06\x60\x0d\xf0\x1b\xf8\x37\xfc\x67\xfe\xff\xff\xff\xff\x0b\xf0\x0f\xf0\x0f\xf0\x0f\xf0\x0f\xf0\x0f\xf0\x0f\xf0')
back = bytearray(b'\x0f\xf0\x3f\xfc\x7f\xfe\x7f\xfe\xfd\xff\xf9\xff\xf0\x07\xe0\x07\xe0\x07\xf0\x07\xf9\xff\xfd\xff\x7f\xfe\x7f\xfe\x3f\xfc\x0f\xf0')
image = bytearray(b'\x01\x00\x01\xb0\x07\xe0\x09\xd0\x10\xc8\x20\x84\x46\x12\x43\x32\x40\x22\x46\x02\x43\x92\x20\xf4\x10\x08\x0c\x30\x03\xc0\x00\x00')
fb2 = framebuf.FrameBuffer(image, 16, 16, framebuf.MONO_HLSB)
fb.blit(fb2, 10, 60)

fb3 = framebuf.FrameBuffer(back, 16, 16, framebuf.MONO_HLSB)
fb.blit(fb3, 30, 60)

fb4 = framebuf.FrameBuffer(up, 16, 16, framebuf.MONO_HLSB)
fb.blit(fb4, 50, 60)

from fb_numbers import NUMBERS
from fb_top_icons import TOP_ICONS

example = bytearray(b'\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x00\x0c\x00\x00\x00\xe0\x00\x00\x00\x00\x00\x00\xc0\x00\x00\x80\x00\x1f\x00\x00\x03\xf0\x00\x00\x08\x00\x00\x18\xc6\x00\x01\x80\x0f\xff\xe0\x00\x07\xf8\x00\x00\x1c\x00\x00\x1c\xce\x00\x03\x80\x9f\xff\xfc\x00\x03\xf8\x00\x00\x1c\x00\x00\x18\xc6\x00\x03\x81\x8f\xff\xf0\x00\x07\xf8\x00\x00\x3e\x00\x01\x8c\xcc\x60\x07\x81\xc0\x1f\x80\x01\xdf\xfe\x60\x00\x3e\x00\x01\xcf\xfc\xe0\x07\x81\xc0\x1c\x00\x07\xfe\x1f\xf8\x00\x7f\x00\x00\x6f\xfd\x80\x07\x83\xc0\x00\x0c\x0f\xfc\x07\xfc\x00\xf7\x80\x00\x7f\xff\x80\x07\x83\xe0\x00\x0c\x07\xf0\x01\xf8\x00\xf7\x80\x0e\x7c\x0f\x1c\x07\x83\xe0\x00\x0c\x07\xc0\x00\xfc\x01\xe3\xc0\x0f\xf8\x07\xfc\x07\x87\xe0\x00\x0c\x0f\xc0\x00\x78\x03\xc1\xe0\x05\xf0\x03\xe8\x03\x87\xf0\x00\x0c\x07\xc0\x00\x60\x07\x80\xf0\x00\xe0\x01\xc0\x01\x87\xf0\x00\x0c\x01\xc0\x00\x70\x0f\x00\x78\x00\xe0\x01\xc0\x00\x81\xc0\x00\x0c\x01\xc0\x00\x70\x1e\x00\x3c\x1d\xe0\x01\xee\x00\x81\xc0\x00\x0c\x01\xc0\x00\x70\x3c\x00\x1e\x1d\xe0\x01\xee\x1f\x81\xc0\x00\x3f\x03\xc0\x00\x70\x3c\x00\x0e\x00\xe0\x01\xc0\x3f\x81\xc0\x00\x3f\x0f\xc0\x00\x78\x38\x00\x0e\x00\xe0\x01\xe0\x3f\x81\xc0\x00\x3f\x0f\xc0\x00\x7c\x38\x00\x0f\x07\xf0\x03\xf8\x3f\x81\xc0\x00\x3f\x07\xf0\x01\xf8\x38\x00\x07\x0e\xf8\x07\xdc\x3f\x81\xc0\x00\x1e\x0f\xf8\x07\xf8\x38\x00\x0f\x0e\x3c\x0f\x1c\x3f\x81\x80\x00\x1e\x0f\xfe\x1f\xf8\x38\x00\x0e\x00\x7f\xff\x80\x3f\x80\x03\xc0\x1c\x01\xdf\xbf\x78\x3c\x00\x1e\x01\xef\xfd\x40\x1f\x80\x1f\xc0\x0c\x01\x8f\xfc\x60\x1e\x00\x3c\x01\xcf\xfc\xe0\x0f\x80\xff\xff\xcc\x00\x03\xf8\x00\x0f\xc0\xf8\x01\x84\xc8\x60\x07\x80\xff\xff\xc8\x00\x07\xf8\x00\x07\xff\xf0\x00\x18\x0e\x00\x03\x80\x1f\xc0\x00\x00\x03\xf8\x00\x03\xff\xe0\x00\x1c\xce\x00\x00\x80\x07\xc0\x00\x00\x00\xe8\x00\x00\x7f\x00\x00\x18\xc6\x00\x00\x80\x00\x00\x00\x00\x00\x40\x00\x00\x00\x00\x00\x00\xc0\x00\x00\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x8f\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x87\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x30\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\xf8\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\xfc\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x81\xdc\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x81\xdc\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x81\xdc\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x81\xdc\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x81\xdc\x00\x00\x01\xff\xff\xff\x80\x00\x07\xff\xff\xfe\x00\x00\x81\xfc\x00\x00\x07\xff\xff\xff\xc0\x00\x0f\xff\xff\xff\x80\x00\x81\xfc\x00\x00\x0f\xff\xff\xff\xe0\x00\x1f\xff\xff\xff\xc0\x00\x81\xfc\x00\x00\x1f\xff\xff\xff\xf0\x00\x3f\xff\xff\xff\xe0\x00\x81\xfc\x00\x00\x1f\xff\xff\xff\xf0\x00\x3f\xff\xff\xff\xe0\x00\x81\xfc\x00\x00\x0f\xff\xff\xff\xdc\x03\xdf\xff\xff\xff\xb0\x00\x81\xfc\x00\x00\x07\xff\xff\xff\xfc\x03\xef\xff\xff\xff\x78\x00\x83\xfe\x00\x00\x03\xff\xff\xff\xfe\x07\xef\xff\xff\xfe\xf8\x00\x83\xff\x00\x00\x01\xff\xff\xfe\xfe\x0f\xfb\xff\xff\xff\xfc\x00\x87\xff\x00\x00\x00\xff\xff\xf9\xfe\x0f\xf9\xff\xff\xf7\xfc\x00\x87\xff\x00\x00\x00\x00\x00\x03\xff\x0f\xf8\x00\x00\x07\xfc\x00\x87\xff\x00\x00\x00\x00\x00\x03\xff\x0f\xf8\x00\x00\x07\xfc\x00\x87\xff\x00\x00\x00\x00\x00\x03\xff\x0f\xf8\x00\x00\x07\xfc\x00\x83\xff\x00\x00\x00\x00\x00\x03\xfe\x1f\xf8\x00\x00\x0f\xfc\x00\x81\xfe\x00\x00\x00\x00\x00\x03\xfe\x1f\xf8\x00\x00\x0f\xfc\x00\x80\xfc\x00\x00\x00\x00\x00\x07\xfe\x1f\xf0\x00\x00\x0f\xf8\x00\x80\x00\x00\x00\x00\x00\x00\x07\xfe\x1f\xf0\x00\x00\x0f\xf8\x00\x80\x00\x00\x00\x00\x00\x00\x07\xfe\x1f\xf0\x00\x00\x0f\xf8\x00\x80\x00\x00\x00\x00\x00\x00\x07\xfc\x3f\xf0\x00\x00\x0f\xf8\x00\x80\x00\x00\x00\x00\x00\x00\x07\xfc\x3f\xf0\x00\x00\x1f\xf8\x00\x80\x00\x00\x00\x00\x00\x00\x0f\xfc\x3f\xe0\x00\x00\x1f\xf8\x00\x80\x00\x00\x00\x00\x00\x00\x0f\xfc\x3f\xe0\x00\x00\x1f\xf0\x00\x80\x00\x00\x00\x00\x00\x00\x0f\xfc\x3f\xe0\x00\x00\x1f\xf0\x00\x80\x00\x00\x00\x00\x00\x00\x0f\xfc\x3f\xe0\x00\x00\x1f\xf0\x00\x80\x00\x00\x00\x00\x00\x00\x0f\xf8\x7f\xe0\x00\x00\x1f\xf0\x00\x80\x00\x00\x00\x00\x00\x00\x0f\xf8\x7f\xe0\x00\x00\x3f\xf0\x00\x80\x00\x00\x00\x00\x00\x00\x1f\xf8\x7f\xc0\x00\x00\x3f\xf0\x00\x80\x00\x00\x00\x00\x00\x00\x1f\xf8\x7f\xc0\x00\x00\x3f\xe0\x00\x80\x00\x00\x00\x00\x00\x00\x1f\xf8\x7f\xc0\x00\x00\x3f\xe0\x00\x80\x00\x00\x00\x00\x00\x00\x1f\xf8\x7f\xc0\x00\x00\x3f\xe0\x00\x80\x00\x00\x00\x00\x00\x00\x1f\xf0\x7f\xc0\x00\x00\x7f\xe0\x00\x80\x00\x00\x00\x00\x00\x00\x1f\xf0\x7f\x80\x00\x00\x3f\xe0\x00\x80\x00\x00\x00\x3f\xff\xff\xef\xf0\x3f\x7f\xff\xff\xdf\xe0\x00\x80\x00\x00\x00\x7f\xff\xff\xf7\xe0\x1f\xff\xff\xff\xef\xc0\x00\x80\x00\x00\x00\xff\xff\xff\xff\xe0\x0d\xff\xff\xff\xef\x80\x00\x80\x00\x00\x03\xff\xff\xff\xfd\x00\x07\xff\xff\xff\xfe\x00\x00\x80\x00\x00\x0d\xff\xff\xff\xfc\x00\x37\xff\xff\xff\xf8\x00\x00\x80\x00\x00\x3d\xff\xff\xff\xf8\x00\x7b\xff\xff\xff\xf0\x00\x00\x80\x00\x00\x7f\xff\xff\xff\xef\x00\xfd\xff\xff\xff\xde\x00\x00\x80\x00\x00\x7f\x7f\xff\xff\xff\x81\xff\xff\xff\xff\xbe\x00\x00\x80\x00\x00\xff\x80\x00\x00\x3f\xc1\xff\x00\x00\x00\xff\x00\x00\x80\x00\x00\xff\xc0\x00\x00\x7f\xc1\xff\x00\x00\x00\xff\x80\x00\x80\x00\x00\xff\xc0\x00\x00\x7f\xc3\xff\x00\x00\x00\xff\x80\x00\x80\x00\x00\xff\x80\x00\x00\x7f\xc3\xff\x00\x00\x01\xff\x80\x00\x80\x00\x00\xff\x80\x00\x00\x7f\xc3\xff\x00\x00\x01\xff\x80\x00\x80\x00\x01\xff\x80\x00\x00\x7f\xc3\xfe\x00\x00\x01\xff\x00\x00\x80\x00\x01\xff\x80\x00\x00\xff\xc3\xfe\x00\x00\x01\xff\x00\x00\x80\x00\x01\xff\x80\x00\x00\xff\xc3\xfe\x00\x00\x01\xff\x00\x00\x80\x00\x01\xff\x00\x00\x00\xff\x87\xfe\x00\x00\x03\xff\x00\x00\x80\x00\x01\xff\x00\x00\x00\xff\x87\xfe\x00\x00\x03\xff\x00\x00\x80\x00\x03\xff\x00\x00\x00\xff\x87\xfe\x00\x00\x03\xff\x00\x00\x80\x00\x03\xff\x00\x00\x01\xff\x87\xfc\x00\x00\x03\xfe\x00\x00\x80\x00\x03\xff\x00\x00\x01\xff\x87\xfc\x00\x00\x03\xfe\x00\x00\x80\x00\x03\xfe\x00\x00\x01\xff\x07\xfc\x00\x00\x07\xfe\x07\xf0\x80\x00\x03\xfe\x00\x00\x01\xff\x0f\xfc\x00\x00\x07\xfe\x07\xf8\x80\x00\x03\xfe\x00\x00\x01\xff\x0f\xfc\x00\x00\x07\xfe\x0e\x3c\x80\x00\x07\xfe\x00\x00\x03\xff\x0f\xfc\x00\x00\x07\xfc\x0f\x3d\x80\x00\x07\xfe\x00\x00\x03\xff\x0f\xfc\x00\x00\x07\xfc\x0f\xfb\x80\x00\x07\xfe\x00\x00\x03\xff\x0f\xf8\x00\x00\x07\xfc\x03\xf7\x80\x00\x07\xfc\x00\x00\x03\xfe\x1f\xf8\x00\x00\x0f\xfc\x00\x87\x80\x00\x07\xfc\x00\x00\x03\xfe\x1f\xf8\x00\x00\x0f\xfc\x00\x0f\x80\x00\x07\xfc\x00\x00\x07\xfe\x1f\xf8\x00\x00\x0f\xfc\x00\x0f\x80\x00\x07\xfc\x00\x00\x07\xfe\x1f\xf8\x00\x00\x0f\xfc\x00\x0f\x80\x00\x07\xf7\xff\xff\xfb\xfe\x0f\xef\xff\xff\xf7\xf8\x00\x0f\x80\x00\x07\xff\xff\xff\xfd\xfc\x0f\xdf\xff\xff\xfb\xf8\x00\x0f\x80\x00\x03\xdf\xff\xff\xfe\x78\x07\xff\xff\xff\xfd\xf0\x00\x07\x80\x00\x01\xbf\xff\xff\xff\x70\x07\xff\xff\xff\xfe\xe0\x00\x07\x80\x00\x00\x7f\xff\xff\xff\x80\x01\xff\xff\xff\xff\x00\x00\x07\x80\x00\x00\xff\xff\xff\xff\x80\x01\xff\xff\xff\xff\x00\x00\x03\x80\x00\x00\x7f\xff\xff\xff\x80\x01\xff\xff\xff\xff\x00\x00\x01\x80\x00\x00\x3f\xff\xff\xfe\x00\x00\x7f\xff\xff\xfc\x00\x00\x00\x80\x00\x00\x0f\xff\xff\xf8\x00\x00\x1f\xff\xff\xf0\x00\x00\x00\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00')

fb5 = framebuf.FrameBuffer(example, 128, 122, framebuf.MONO_HLSB)
fb.blit(fb5, 0, 5)

example2 = bytearray(b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\xf8\x00\x00\x00\x1c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x07\xfc\x00\x00\x00\x7f\x00\x00\x00\x60\x00\x00\x3c\x00\x00\x00\x0f\xfc\x00\x00\x00\x7f\x00\x00\x0f\xfe\x00\x01\xff\x80\x00\x00\x0f\xfc\x3f\x00\x00\x7f\x00\x00\x3f\xff\x80\x07\xff\xc0\x00\x00\x1f\xfc\x7f\xc0\x00\xff\x80\x00\x7f\xff\xc0\x0f\x01\xe0\x00\x00\x1f\xfc\xff\xe0\x39\xff\xee\x00\x7f\xf1\xe0\x1e\x00\x70\x00\x00\x1f\xfd\xff\xe0\xff\xe3\xff\x00\xff\xf7\xe0\x38\xfe\x38\x00\x00\x1f\xf9\xff\xf0\xff\x80\xff\x80\xff\xf7\xe0\x3b\xff\x98\x00\x00\x1f\xfb\xff\xf0\xfe\x03\xff\x80\xff\xf7\xe0\x37\xc7\xd8\x00\x00\x1f\xfb\xff\xf0\xfc\x0f\xcf\x80\xff\xf1\xe0\x0f\x01\xe0\x00\x00\x0f\xff\xff\xf0\xf8\x7e\x8f\x80\xf1\xf3\xe0\x0e\x00\xf0\x00\x00\x07\xff\xff\xf0\xf9\xff\xee\x00\xf1\xf7\xe0\x1c\x7c\x70\x00\x00\x01\xff\xff\xe0\x38\xf7\xce\x00\xf3\xf7\xe0\x08\xfe\x30\x00\x00\x00\x39\xc3\xc0\x38\x1e\x6e\x00\xfb\xf7\xe0\x01\xff\x00\x00\x00\x7e\x3f\xf0\x00\x3b\xff\xee\x00\xfb\xf7\xe0\x01\xff\x00\x00\x00\xff\xff\xfc\x00\x7b\xff\xce\x00\xfb\xe3\xe0\x01\xff\x80\x00\x00\xff\xff\xfe\x00\xfa\x1f\x0f\x80\xff\x99\xe0\x01\xff\x80\x00\x00\xff\xff\xff\x00\xfb\xfc\x0f\x80\xff\xbe\xe0\x01\xff\x80\x00\x00\xff\xf9\xff\x80\xff\xf8\x3f\x80\xff\xbe\xe0\x01\xff\x00\x00\x00\xff\xf9\xff\x80\xff\x80\xff\x80\xff\xbe\xe0\x01\xff\x00\x00\x00\xff\xf9\xff\x80\xff\xc1\xff\x80\xff\x9c\xe0\x00\xfe\x00\x00\x00\x7f\xf3\xff\x80\x3b\xf7\xef\x00\xff\xc1\xe0\x00\x7c\x00\x00\x00\x3f\xf3\xff\x80\x18\xff\xce\x00\xff\xff\xe0\x00\x00\x00\x00\x00\x1f\xe3\xff\x80\x00\x7f\x00\x00\xff\xff\xe0\x00\x00\x00\x00\x00\x0f\x87\xff\x00\x00\x7f\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\xfe\x00\x00\x7f\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\xfc\x00\x00\x1f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf0\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xf0\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xf0\x00\x00\x00\x0e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\xfc\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x01\xfc\x00\x00\x00\x30\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x03\xfe\x3e\x00\xfe\x3e\x00\x00\xff\xff\xff\xc0\x00\x00\x00\x0e\x07\xfe\x7f\x03\xff\x9f\x00\x01\xff\xff\xff\xe0\x00\x00\x00\x0e\x07\xfc\xff\x83\xc7\xc7\x80\x01\xff\xff\xff\xe0\x00\x00\x00\x0e\x07\xfd\xff\x87\x0f\xe3\x80\x07\xc0\x00\x01\xe0\x00\x00\x00\x0e\x07\xfd\xff\xce\x1f\xe1\xc0\x0f\xc0\x00\x03\xe0\x00\x00\x00\x0e\x03\xfd\xff\xce\x7c\xf0\xc0\x0e\xc0\x00\x07\xe0\x00\x00\x00\x0e\x03\xff\xff\xcc\x78\x70\xc0\x0d\xc0\x00\x07\xe0\x00\x00\x00\x0e\x01\xff\xff\xcc\xf0\x70\xc0\x0d\xc0\x00\x0f\xe0\x00\x00\x00\x0e\x00\x7f\xff\x8c\xf8\x70\xc0\x0c\xc0\x00\x0f\xe0\x00\x00\x00\x0e\x07\x1d\xc2\x0e\xf8\x71\xc0\x0f\xc0\x00\x1f\xe0\x00\x00\x00\x0e\x1f\xff\xf8\x0f\xdf\xe1\xc0\x07\xc0\x00\x1f\xe0\x00\x00\x00\x0e\x1f\xff\xfc\x05\xdf\xc3\x80\x01\xff\xff\xff\xe0\x00\x00\x00\x0e\x1f\xff\xfe\x01\xcf\xdf\x00\x01\xff\xff\xff\xe0\x00\x00\x00\x0e\x1f\xfd\xfe\x00\xc7\xfe\x00\x00\xff\xff\xff\xe0\x00\x00\x00\x0e\x1f\xfd\xff\x00\xe1\xfc\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x0f\xf9\xff\x00\xf0\x30\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x0f\xf3\xff\x00\x7c\x78\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x07\xe3\xfe\x00\x3f\xf0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\x83\xfc\x00\x0f\xe0\x03\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\x01\xf8\x00\x00\x00\x0f\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\x00\xe0\x00\x00\x00\x1f\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\x00\x00\x00\x00\x00\xbf\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\x00\x18\x00\x00\x07\xbf\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x03\x00\xfe\x00\x00\x1f\xbf\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x07\x01\xff\x80\x00\x1f\xbf\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x06\x01\xff\xc0\x01\xdf\xbf\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x06\x41\xff\xe0\x0f\xdf\xbf\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x0c\xe0\xff\xe0\x0f\xdf\xbf\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x0c\xe0\xff\xe0\xcf\xdf\xbf\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x1c\x00\xef\xe3\xcf\xdf\xbf\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x18\x00\x6f\xe7\xcf\xdf\xbf\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x38\x00\xfc\x67\xcf\xdf\xbf\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x1f\x00\xf8\x67\xcf\xdf\xbf\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x07\x00\x30\xe7\xcf\xdf\xbf\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x03\x00\xe0\xc7\xcf\xdf\xbf\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x03\x01\xc0\xc7\xcf\xdf\xbf\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x03\x01\xc1\x80\x04\x88\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x03\x00\xe3\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x03\x00\x63\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x03\xf0\x63\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x01\xf0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\x00\x00\x00\x00\x07\xfc\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\x00\x00\x00\x00\x0f\xfc\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\x00\x00\x00\x00\x1e\x3c\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\x00\x00\x00\x00\x1c\x3c\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\x00\xc0\x00\x00\x1c\x3c\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x03\xf9\xf0\x00\x00\x1c\x3c\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x0f\xfd\xf8\x00\x00\x1c\x3c\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x1f\xff\x3c\x00\x0e\x1c\x3c\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x3c\x3f\x1e\x3f\xfe\x1c\x3c\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x38\xff\x8e\x3f\xf8\x1c\x3c\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x71\xff\x87\x3f\xe0\x0e\x3c\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x73\xe3\xc7\x3f\x83\x8f\x3c\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x77\xc1\xc7\x3c\x0f\x07\xfc\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x77\xc1\xc7\x10\x7e\x03\xfc\x00\x00\x00\x00\x00\xc0\x0e\x00\x0e\x77\xc3\xc7\x01\xfc\x60\x7c\x00\x00\x00\x00\x00\xe0\xff\xe0\x0e\x7f\xe7\x8e\x0f\xf8\xe0\x00\x00\x00\x00\x00\x00\xf3\xff\xf8\x0e\x3e\xff\x1e\x0f\xe1\xc4\x00\x00\x00\x00\x00\x00\xf7\xff\xfc\x0e\x0f\x7f\x3c\x0f\xc3\xcc\xc0\x00\x00\x00\x00\x00\xef\xff\xfe\x0e\x0f\x3f\xf8\x07\x8f\x9c\xc0\x00\x00\x00\x00\x00\xdf\xc0\x3e\x0e\x07\x1f\xf1\x83\x1f\x18\xc0\x00\x00\x00\x00\x00\x1f\x80\x3f\x0e\x07\x87\xc1\xc0\x3f\x39\xc0\x00\x00\x00\x00\x00\x3f\x00\x00\x0e\x03\xe1\xc1\xe0\x7e\x79\xc0\x00\x00\x00\x00\x00\x3f\x00\x00\x0e\x01\xff\xc1\xf0\xfc\x79\xc0\x00\x00\x00\x00\x00\x3f\x00\x00\x0e\x00\xff\x81\xf0\x7c\xf3\xc0\x00\x00\x00\x00\x00\x3f\x00\x00\x0e\x00\x3e\x01\xe0\x39\xf3\xc0\x00\x00\x00\x00\x00\x3f\x00\x3f\x0e\x00\x00\x00\x60\x11\xf3\xc0\x00\x00\x00\x00\x00\x1f\x80\x3f\x0e\x00\x00\x00\x70\x03\xf7\xc0\x00\x00\x00\x00\x00\x1f\x80\x7e\x0e\x00\x00\x00\x38\x03\xe7\xc0\x00\x00\x00\x00\x00\x1f\xc0\x7e\x0e\x00\x00\x00\x3c\xc0\xe7\xc0\x00\x00\x00\x00\x00\x0f\xff\xfc\x0e\x00\x00\x00\x1f\xe0\x07\xc0\x00\x00\x00\x00\x00\x07\xff\xf8\x0e\x00\x00\x00\x07\xf0\x03\x80\x00\x00\x00\x00\x00\x00\xff\xe0\x0e\x00\x00\x00\x03\xf8\x00\x00\x00\x00\x00\x00\x00\x00\x3f\x80\x0e\x00\x00\x00\x01\xfc\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\x00\x00\x01\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00')
fb6 = framebuf.FrameBuffer(example2, 128, 122, framebuf.MONO_HLSB)
fb.blit(fb6, 250-128, 5)

print('number')
fb.blit(NUMBERS['3'], 10, 10)

fb.blit(TOP_ICONS['wifi'], 10, 50)
fb.blit(TOP_ICONS['econo_cool'], 100, 50)
fb.blit(TOP_ICONS['fan'], 50, 50)


epd.set_frame_memory(buf,0,0,epd.width,epd.height)
epd.display_frame()
epd.sleep()



while True:
    sleep_ms(10000)  # wait for 2 seconds before doing a partial update

# --------------------

epd.init(epd.PART_UPDATE)

fb = framebuf.FrameBuffer(buf, 200, 32, framebuf.MONO_VLSB)
fb.fill(0x0)
for i in range(0,32/2-1,2):
    fb.rect(i, i, 200-i*2, 32-i*2, 0xffff)

epd.set_frame_memory(buf,8,32,32,200) # 8px from bottom, 25px from left

epd.display_frame()

fb.text('MicroPython!', 2, 6 + 2, 0xffff)
fb.rect(0, 6, 250, 122, 0xffff)
epd.set_frame_memory(buf,0,0,epd.width,epd.height)
epd.display_frame()


print('4')
while True:
    epd.display_frame()
    print('5')
    time.sleep(1)

iro = Pin(17, Pin.OUT, Pin.PULL_DOWN)
iro.off()
    
def send_code(pin, code):
    pwm = PWM(pin)
    pwm.freq(38000)

    for element in code:
        if element > 0:           
            pwm.duty_u16((2**16)//3)
        else:
            pwm.duty_u16(0)
            
        utime.sleep_us(abs(element))
               
    pwm.deinit()
    pin.off()
    
    
data = '3358 -1678 420 -1260 420 -1260 420 -420 420 -420 420 -420 420 -1260 420 -420 420 -420 420 -1260 420 -1260 420 -420 420 -1260 420 -420 420 -420 420 -1260 420 -1260 420 -420 420 -1260 420 -1260 420 -420 420 -420 420 -1260 420 -420 420 -420 420 -1260 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -1260 420 -420 420 -420 420 -420 420 -420 420 -420 420 -1260 420 -1260 420 -420 420 -420 420 -420 420 -420 420 -1260 420 -420 420 -1260 420 -420 420 -420 420 -420 420 -420 420 -420 420 -1260 420 -1260 420 -420 420 -1260 420 -1260 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -1260 420 -420 420 -1260 420 -420 420 -1260 420 -420 420 -420 420 -1260 420 -1260 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -1260 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -1260 420 -420 420 -420 420 -1260 420 -1260 420 -420 420 -1260 404 -11364 3358 -1678 420 -1260 420 -1260 420 -420 420 -420 420 -420 420 -1260 420 -420 420 -420 420 -1260 420 -1260 420 -420 420 -1260 420 -420 420 -420 420 -1260 420 -1260 420 -420 420 -1260 420 -1260 420 -420 420 -420 420 -1260 420 -420 420 -420 420 -1260 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -1260 420 -420 420 -420 420 -420 420 -420 420 -420 420 -1260 420 -1260 420 -420 420 -420 420 -420 420 -420 420 -1260 420 -420 420 -1260 420 -420 420 -420 420 -420 420 -420 420 -420 420 -1260 420 -1260 420 -420 420 -1260 420 -1260 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -1260 420 -420 420 -1260 420 -420 420 -1260 420 -420 420 -420 420 -1260 420 -1260 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -1260 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -420 420 -1260 420 -420 420 -420 420 -1260 420 -1260 420 -420 420 -1260 420'

code = [int(element) for element in data.split(' ')]

while True:
    send_code(iro, code)
    print('ok')
    time.sleep(1)
    
